# Nut Classification CNN

## Описание проекта
Этот проект представляет собой сверточную нейронную сеть (CNN), разработанную для классификации орехов на "хорошие" и "плохие". Нейросеть обучается на изображениях орехов, после чего может предсказывать качество новых изображений.

Модель была разработана как дипломный проект и может быть адаптирована для классификации других товаров или промышленных задач (например, контроль качества продукции или распознавание объектов в таможенном деле).

Точность модели на тестовых данных из 5000 изображений составила **94.80%**.

## Используемые технологии
- Python 3.8+
- TensorFlow + Keras
- NumPy
- ImageDataGenerator для загрузки изображений

## Установка
Перед началом работы установите зависимости:
```sh
pip install tensorflow numpy keras
```

## Подготовка данных
В ходе работы было отснято **5000 фотографий орехов** на **зеленом фоне** в двух классах:
- **2500 фотографий хороших орехов**
- **2500 фотографий плохих орехов**

Примеры изображений:
- ![Хороший орех](ссылка_на_изображение_1)
- ![Плохой орех](ссылка_на_изображение_2)

### Организация данных
Необходимо создать директорию `data/` с подпапками:
```
data/
├── train/      # 4000 изображений (80%)
│   ├── good/   # 2000 изображений
│   ├── bad/    # 2000 изображений
├── val/        # 500 изображений (10%)
│   ├── good/   # 250 изображений
│   ├── bad/    # 250 изображений
├── test/       # 500 изображений (10%)
│   ├── good/   # 250 изображений
│   ├── bad/    # 250 изображений
```

## Обучение модели
Запустите Python-скрипт для обучения модели:
```sh
python Сверточная_нейронная_сеть.py
```
После обучения модель сохранится в файле `nut_classifier.h5`. Файл **.h5** используется для хранения весов обученной модели в Keras.

## Пример использования модели
```python
from keras.models import load_model
from keras.preprocessing import image
import numpy as np

# Загрузка предобученной модели
model = load_model("nut_classifier.h5")

# Загрузка изображения
img = image.load_img("path/to/image.jpg", target_size=(150, 150))

# Преобразование изображения в массив и нормализация
x = image.img_to_array(img) / 255.0
x = np.expand_dims(x, axis=0)

# Предсказание класса изображения
prediction = model.predict(x)[0][0]

# Вывод результата
print("Хороший орех" if prediction > 0.5 else "Плохой орех")
```

## Как обучить модель на своих данных?
1. Подготовьте свою базу изображений, разложив их по папкам (`train/`, `val/`, `test/`).
2. Укажите пути к данным в скрипте.
3. Запустите обучение.
4. Используйте полученную модель для предсказаний на новых данных.

## Возможные доработки
- Вы можете добавить настройку гиперпараметров через конфигурационный файл.
- Улучшение генерации данных (аугментация изображений).
- Добавление большего числа слоев требует тестирования на предмет улучшения/ухудшения **accuracy**.

## Лицензия
Проект распространяется под лицензией **MIT**.